- sub_header('Product', @product.name)

= content do
  %ul#summary
    %li
      - if @product.published?
        %span.value.indicator.ok Published
      - else
        %span.value.indicator Unpublished

    %li
      - if @product.for_sale?
        %span.value.indicator.ok For Sale
      - elsif @product.discontinued?
        %span.value.indicator Discontinued
      - else
        %span.value.indicator Not for Sale

    %li
      %span(class="value indicator #{@product.stock_warning? ? 'warning' : 'ok'}")
        Stock Level:
        = @product.stock_level_status.capitalize

  %div.overview
    = column(4, :class => 'asset-preview') do
      %div.frame
        - if @product.images.empty?
          %span(class='no-preview #{@asset.kind}') &nbsp;
        - else
          = image_tag(@product.images.first.preview.url(:thumb))

    = column(8) do
      %ul.key-value
        %li
          %span.key Category
          %span.value= @product.category.name

        - if @product.range
          %li
            %span.key Ranges
            %span.value= @product.range.name

        %li
          %span.key Description
          %div.value
            = simple_format(@product.description)

  %h3.inset SKUs

  %table.inset
    %thead
      %tr
        %th.boolean Published
        %th.boolean For Sale
        %th SKU
        %th.indicator Price
        %th.indicator Stock Level
        %th.meta Updated At

    %tbody
      - @product.skus.summary.each do |sku|
        %tr
          %td.boolean
            = boolean_indicator(sku.published?)
          %td.boolean
            = boolean_indicator(sku.for_sale?)
          %td
            %span.title= sku.short_desc
          %td.indicator
            %span.indicator= sku.formatted_price
          %td.indicator.adjust
            %span.indicator= sku.stock_level
            = link_to('Adjust', '', :class => 'button')
          %td.meta
            %span.time= sku.updated_at
            by #{sku.updater_name}

  %h3.inset Stock Logs

  %table.inset
    %thead
      %tr
        %th SKU
        %th Action
        %th Movement
        %th Level
        %th On

    %tbody
      - @product.stock_logs.summary.each do |log|
        %tr
          %td
            %span.title= log.short_desc
          %td
            = log.action.humanize
          %td.indicator
            %span.indicator= log.movement
            %span(class="dir #{log.direction}")
              %span= log.direction
          %td.indicator
            %span.indicator= log.after
          %td.meta
            %span.time= log.created_at
            by #{log.creator_name}

  %h3.inset Price Adjustments

  %table.inset
    %thead
      %tr
        %th SKU
        %th Movement
        %th Price
        %th On

    %tbody
      - @product.price_logs.summary.each do |log|
        %tr
          %td
            %span.title= log.short_desc
          %td.indicator
            %span.indicator= log.formatted_movement
            %span(class="dir #{log.direction}")
              %span= log.direction
          %td.indicator
            %span.indicator= log.formatted_after
          %td.meta
            %span.time= log.created_at
            by #{log.creator_name}

= footer do
  = edit_button(@product)
  - if @product.destroyable?
    = delete_button(@product)
